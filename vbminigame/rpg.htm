<html>
<head>
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="description" content="VB6で作成したミニゲームのソースコードを紹介">
<meta name="keywords" content="VB,ゲーム,ミニゲーム,VisualBasic,VB,Visual,Basic,ゲーム,プログラム">
<link rel="stylesheet" href="style.css" type="text/css">
<title>VB6でミニゲーム作成 -RPG-</title>
</head>
<body lang="ja">

<div id="top">
	<h1><img src="pic/title.bmp" alt="VB6でミニゲーム作成"></h1>
</div>

<hr>

							<!-- ***** メニュー ***** -->
<div id="menu">
	<ul class="menulist1">
		<li id="index"><a href="../index.html">はじめに</a></li>
		<li id="start"><a href="start.htm">ゲーム作成の土台作り</a></li>
		<li id="gamemodule"><a href="gamemodule.htm">ゲーム専用モジュール</a></li>
		<li id="slide"><a href="slidegame.htm">スベリゲーム</a></li>
		<li id="block"><a href="block.htm">ブロック崩し</a></li>
		<li id="reversi"><a href="reversi.htm">リバーシ</a></li>
		<li id="stg"><a href="stg.htm">シューティング</a></li>
		<li id="rpg"><a href="rpg.htm">RPG</a></li>
		<li id="action"><a href="action.htm">アクション</a></li>
		<li id="javagame"><a href="javagame.htm">Javaゲーム</a></li>
	</ul>

	<script type="text/javascript"><!--
	google_ad_client = "pub-3116106279235219";
	/* 160x600, 作成済み 08/06/07 */
	google_ad_slot = "5430967571";
	google_ad_width = 160;
	google_ad_height = 600;
	//-->
	</script>
	<script type="text/javascript"
	src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
	</script>

</div>

<hr>
<div id="theme">
	VB6で作成したミニゲームのソースコードを紹介
</div>
							<!-- ***** メインコンテンツ ***** -->
<div id="content">
	<h2>RPG</h2>
	<p>
		<img src="pic/rpg.bmp" alt="RPG"><br>
		<br>
		<img src="pic/rpgedit.bmp" alt="RPGエディタ"><br>
	</p>
	<h3>概要</h3>
	<p>
		カーソルキーで主人公を移動し、町の人と会話ができます。<br>
		町の外へ出ると、変な敵がいますが、当り判定などは行っていませんので、無害です。<br>
		マップエディタが付属しているので、町の中やフィールドなど、地形を自由に改変できます。
	</p>
	<h3>ソースファイル</h3>
	<p>
		まずはソースファイルをダウンロードして下さい。
	</p>
	<div id="download">
		<a href="file/rpg.lzh">RPGのソースファイルをダウンロード</a>
	</div>
	<p>
		プロジェクトファイル（Rpg.vbp）を開くと、4つのファイルがあります。<br>
		<img src="pic/rpgprj.bmp" alt="プロジェクト一覧"><br>
	</p>
	<dl>
		<dt>API(Api.bas)
		<dd>ゲーム専用APIモジュール
		<dt>frmMain(frmMain.frm)
		<dd>メイン画面専用フォーム
		<dt>frmPic(frmPic.frm)
		<dd>ゲーム画像専用フォーム
		<dt>mdlMain(mdlMain.bas)
		<dd>メインプログラム専用モジュール
	</dl>
	<p>
		API（Api.bas）については、<a href="gamemodule.htm">ゲーム専用モジュール</a>をご参照下さい。<br>
		frmMainがゲームのメイン画面になります。<br>
		キャラクターやマップチップはfrmPicにあります。<br>
		mdlMainが、ゲームのメインプログラムになります。
	</p>
	<h3>メインプログラム</h3>
	<p>
		まず初めに実行されるのがSub Main()です。<br>
		ここからプログラムがスタートし、各種データを読み込み、
		Do〜Loop間でゲームの処理を行っています。<br>
		mdlMainのプロシージャを簡単にご説明します。
	</p>
	<dl>
		<dt>Sub CharaDraw()
		<dd>主人公キャラの描画
		
		<dt>Sub CharaMove(Key As Integer)
		<dd>主人公を動かす
		
		<dt>Sub CharaSetPosition(SetX As Integer, SetY As Integer, Dir As Integer)
		<dd>主人公を画面中央に配置
		
		<dt>Sub EnemyDraw()
		<dd>敵を描画
		
		<dt>Sub FileLoad()
		<dd>各種データの読み込み
		
		<dt>Sub FileSave()
		<dd>各種データの保存
		
		<dt>Function Hit_Percent(Per As Integer) As Boolean
		<dd>30%など、発生したらTrueを返す関数
		
		<dt>Sub KeyJudge()
		<dd>キーの検出
		
		<dt>Sub Main()
		<dd>ここから始まる
		
		<dt>Sub MapDraw()
		<dd>メインマップを描画
		
		<dt>Sub MapLoad(FileName As String)
		<dd>マップファイルを読み込む
		
		<dt>Sub MapMove()
		<dd>マップをスクロールする
		
		<dt>Sub MapMoveEffect()
		<dd>マップ切り替え時のエフェクト
		
		<dt>Sub MessageWindowCerate(cx As Integer, cy As Integer)
		<dd>メッセージウインドウを作成
		
		<dt>Sub PersonDraw()
		<dd>町の人を描画
		
		<dt>Sub SetData()
		<dd>ちょっとした設定
		
		<dt>Sub Timer()
		<dd>タイマー処理をする
		
	</dl>
	<p>
		<script type="text/javascript"><!--
		google_ad_client = "pub-3116106279235219";
		/* メニュー下 */
		google_ad_slot = "1992334596";
		google_ad_width = 200;
		google_ad_height = 90;
		//-->
		</script>
		<script type="text/javascript"
		src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
		</script>
	</p>
	<p>
		<a href="rpg.htm#top">▲上へ移動▲</a>
	</p>
</div>

<hr>

<div class="copy" lang="en">&copy; copyright nori</div>

</body>
</html>
